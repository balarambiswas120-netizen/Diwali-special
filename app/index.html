<!DOCTYPE html> 
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Diwali Skyshot Fireworks</title>
<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: Arial, sans-serif; background: #0a0a0a; color: white; }

  /* Pre-access form */
  #userForm, #paymentScreen {
    position: fixed; top:0; left:0; width:100%; height:100%;
    background: rgba(0,0,0,0.95); display:flex; flex-direction:column;
    justify-content:center; align-items:center; z-index:9999;
  }
  #userForm h2, #paymentScreen h2 { margin-bottom:20px; text-align:center; color:#FFD700; }
  #userForm input, #userForm select {
    margin:10px 0; padding:10px; width:250px; border-radius:5px; border:none;
  }
  #userForm button, #paymentScreen button {
    padding:10px 20px; border:none; border-radius:5px;
    background:#FFD700; color:#000; font-weight:bold; cursor:pointer;
  }
  #countdown { margin-top:20px; color:#FF4500; font-weight:bold; }

  /* Bottom countdown bar */
  #bottomCountdown {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    background: black;
    color: red;
    font-size: 18px;
    font-weight: bold;
    text-align: center;
    padding: 10px 0;
    z-index: 9999;
  }

  /* Main website styling */
  ::-webkit-scrollbar { width: 6px; }
  ::-webkit-scrollbar-track { background: #111; border-radius: 10px; }
  ::-webkit-scrollbar-thumb { background: linear-gradient(to bottom, #FF9933, #FFFFFF, #138808); border-radius: 10px; }
  ::-webkit-scrollbar-thumb:hover { background: linear-gradient(to bottom, #FF7F00, #f0f0f0, #006400); border-radius: 10px; }

  section { min-height: 100vh; display:flex; flex-direction:column; justify-content:center; align-items:center; padding:40px 20px; position:relative; }
  h1 { font-size:3em; margin-bottom:20px; text-shadow: 0 0 10px #FFD700, 0 0 20px #FF4500; z-index:2; }
  .video-container { width:80%; max-width:800px; border-radius:15px; overflow:hidden; box-shadow:0 0 20px #FFD700,0 0 40px #FF4500,0 0 60px #FF6347; z-index:2; }
  iframe { width:100%; height:450px; border:none; display:block; }
  @media(max-width:600px){ iframe{height:250px;} h1{font-size:2em;} }
  canvas { position: fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:1; }

</style>
</head>
<body>

<!-- Pre-access form -->
<div id="userForm">
  <h2>Choose Your Plan</h2>
  <input type="text" id="name" placeholder="Name" required>
  <input type="text" id="phone" placeholder="Phone Number" required>
  <input type="text" id="address" placeholder="Address" required>
  <select id="country" required>
    <option value="">Select Country</option>
    <option value="India">India</option>
    <option value="USA">USA</option>
    <option value="UK">UK</option>
    <option value="Other">Other</option>
  </select>

  <!-- Subscription Plan -->
  <select id="plan" required>
    <option value="">Select Plan</option>
    <option value="30">Free Trial - 1 Month</option>
    <option value="90">$5 - 3 Months</option>
    <option value="365">$15 - 1 Year</option>
  </select>

  <button id="submitBtn">Start</button>
  <div id="countdown"></div>
</div>

<!-- Payment Screen -->
<div id="paymentScreen" style="display:none;">
  <h2>Your Subscription Has Ended</h2>
  <p>Please make payment to continue using the website.</p>
  <button onclick="alert('Redirect to payment gateway')">Pay Now</button>
</div>


<!-- Fireworks canvas -->
<canvas id="fireworks"></canvas>

<!-- Main Website -->
<section>
  <h1>Happy Diwali!</h1>
  <div class="video-container">
    <iframe src="https://www.youtube.com/embed/i7M6oe8efeo" allowfullscreen></iframe>
  </div>
</section>

<section>
  <h1>Celebrate With Lights!</h1>
  <div class="video-container">
    <iframe src="https://www.youtube.com/embed/KkSYbW5vzS4" allowfullscreen></iframe>
  </div>
</section> <br>

<!-- Countdown at bottom -->
<div id="bottomCountdown"></div>

<script>
// Initialize EmailJS
emailjs.init('g7dPxlZeGAIFCQTB2');

const userForm = document.getElementById('userForm');
const paymentScreen = document.getElementById('paymentScreen');
const countdownEl = document.getElementById('countdown');
const bottomCountdown = document.getElementById('bottomCountdown');

let countdownInterval;

// Check subscription status
function checkSubscription() {
  const subscriptionStart = localStorage.getItem('subscriptionStart');
  const subscriptionDays = localStorage.getItem('subscriptionDays');

  if (subscriptionStart && subscriptionDays) {
    const startDate = new Date(subscriptionStart);
    const endDate = new Date(startDate.getTime() + subscriptionDays * 24 * 60 * 60 * 1000);
    const now = new Date();

    if (now >= endDate) {
      userForm.style.display = 'none';
      paymentScreen.style.display = 'flex';
      clearInterval(countdownInterval);
      bottomCountdown.textContent = "Subscription expired!";
    } else {
      userForm.style.display = 'none';
      paymentScreen.style.display = 'none';
      startCountdown(endDate);
    }
  }
}
checkSubscription();

// Real-time countdown
function startCountdown(endDate) {
  countdownInterval = setInterval(() => {
    const now = new Date();
    const diff = endDate - now;

    if (diff <= 0) {
      clearInterval(countdownInterval);
      userForm.style.display = 'none';
      paymentScreen.style.display = 'flex';
      bottomCountdown.textContent = "Subscription expired!";
      return;
    }

    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
    const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((diff % (1000 * 60)) / 1000);

    const timeText = `Time left: ${days}d ${hours}h ${minutes}m ${seconds}s`;
    countdownEl.textContent = timeText; // form screen
    bottomCountdown.textContent = timeText; // bottom bar
  }, 1000);
}

// Submit details
document.getElementById('submitBtn').addEventListener('click', function() {
  const name = document.getElementById('name').value.trim();
  const phone = document.getElementById('phone').value.trim();
  const address = document.getElementById('address').value.trim();
  const country = document.getElementById('country').value;
  const plan = document.getElementById('plan').value;

  if(!name || !phone || !address || !country || !plan){ 
    alert('Please fill all details and select a plan'); 
    return; 
  }

  const templateParams = { name, phone, address, country, plan };
  emailjs.send('service_n0rlufv', 'template_js8rqro', templateParams)
    .then(function(response) {
      const subscriptionDays = parseInt(plan);
      localStorage.setItem('subscriptionStart', new Date().toISOString());
      localStorage.setItem('subscriptionDays', subscriptionDays);
      userForm.style.display = 'none';
      const endDate = new Date(new Date().getTime() + subscriptionDays * 24 * 60 * 60 * 1000);
      startCountdown(endDate);
    }, function(error) {
      alert('Error sending details. Please try again.');
    });
});

// Fireworks JS
const canvas = document.getElementById('fireworks');
const ctx = canvas.getContext('2d');
let cw, ch;
function resizeCanvas(){ cw=canvas.width=window.innerWidth; ch=canvas.height=window.innerHeight; }
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

class Particle {
  constructor(x,y,angle,speed,color){
    this.x=x; this.y=y; this.angle=angle; this.speed=speed; this.color=color;
    this.alpha=1; this.radius=2+Math.random()*2; this.friction=0.98; this.gravity=0.02;
  }
  update(){ this.speed*=this.friction; this.x+=Math.cos(this.angle)*this.speed; this.y+=Math.sin(this.angle)*this.speed+this.gravity; this.alpha-=0.015; }
  draw(){ ctx.save(); ctx.globalAlpha=this.alpha; ctx.beginPath(); ctx.arc(this.x,this.y,this.radius,0,Math.PI*2); ctx.fillStyle=this.color; ctx.fill(); ctx.restore(); }
}
let particles=[];
function createCircleFirework(){
  const x=Math.random()*cw*0.8+cw*0.1; const y=Math.random()*ch*0.5+50;
  const colors=['#FF4500','#FFD700','#FF6347','#FF1493','#00FFFF'];
  const numParticles=50+Math.floor(Math.random()*30);
  for(let i=0;i<numParticles;i++){
    const angle=(Math.PI*2/numParticles)*i; const speed=2+Math.random()*3;
    const color=colors[Math.floor(Math.random()*colors.length)];
    particles.push(new Particle(x,y,angle,speed,color));
  }
}
function animate(){
  ctx.fillStyle='rgba(0,0,0,0.2)'; ctx.fillRect(0,0,cw,ch);
  particles.forEach((p,i)=>{p.update();p.draw();if(p.alpha<=0){particles.splice(i,1);}});
  requestAnimationFrame(animate);
}
setInterval(createCircleFirework,800); animate();
</script>

</body>
</html>
